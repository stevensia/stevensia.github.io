<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="个人技术总结，读书笔记，心得等 | 这里是 Stevensia的个人博客，与君共勉。">
    <meta name="keyword"  content="Python, Steven的博客, Steven Blog, linux">
    <link rel="shortcut icon" href="img/favicon.ico">

    <title>《Linux系统命令及Shell脚本实践指南》读书笔记 - Steven's Blog!</title>

    <link rel="canonical" href="http://universus.cn/book/2015/12/10/linux-system-command-and-shell-guide/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Steven's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About me</a>
                    </li>
                    
                    <li>
                        <a href="/portfolio/">Portfolio</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/bigshows/coding1.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/bigshows/coding1.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-9 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#book" title="book">book</a>
                        
                    </div>
                    <h1>《Linux系统命令及Shell脚本实践指南》读书笔记</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by Steven's Blog on December 10, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-9 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<p>《Linux系统命令及Shell脚本实践指南》这本书挺基础的但是挺有用，比起买的<a href="http://book.douban.com/subject/3519360/">《shell脚本学习指南》</a>读起来还是比较顺畅的。</p>

<p><img src="http://img3.douban.com/mpic/s27193072.jpg" alt="" /></p>

<h1 id="linux">一.Linux用户管理</h1>
<p>之前写一篇博文： <a href="http://beginman.cn/linux/2015/11/13/linux-users-about/"><strong>Linux用户的那些麻烦事</strong></a>作为总结。</p>

<h1 id="linux-1">二.Linux文件管理和文件系统</h1>
<p>## 文件属性<br />
包括：<strong>权限属性和隐藏属性</strong>，权限属性如下：</p>

<pre><code>[team@iZ25mamf7hhZ ~]$ ls -al
total 64
-rw-------   1 team team 1681 Dec 10 17:53 .bash_history
-rw-r--r--   1 team team  124 Oct 16  2014 .bashrc
-rw-rw-r--   1 team team    0 Dec 10 22:51 b.txt
drwxrwxr-x   5 team team 4096 Sep 29 11:27 .npm
drwxr-xr-x   2 root root 4096 Nov 21 10:13 shells
</code></pre>

<p><code>ls -al</code>: <code>-a</code>参数列出隐藏属性，<code>-l</code>列出每个文件的详细信息。</p>

<p><img src="https://camo.githubusercontent.com/db59036cd049fd7375b5a85636c233c77a5d497e/687474703a2f2f3766766635362e636f6d312e7a302e676c622e636c6f7564646e2e636f6d2f6c696e75785f66696c65322e706e67" alt="" /></p>

<p>还是参考之前写的关于<a href="https://github.com/BeginMan/BookNotes/blob/master/Linux/%E9%B8%9F%E5%93%A5%E7%9A%84Linux%E7%A7%81%E6%88%BF%E8%8F%9C%E5%9F%BA%E7%A1%80%E7%AF%87/%E4%B8%80.linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90.md">《鸟哥的Linux私房菜》</a></p>

<p>关于文件的隐藏属性用<code>lsattr</code>来显示，<strong>默认情况下文件的隐藏属性都没有设置</strong>。</p>

<pre><code>lsattr
----ia---j--- ./lsattr_test
</code></pre>

<p>和chmod，ls这些命令相比，chmod只是改变文件的读写、执行权限，更底层的属性控制是由<code>chattr</code>来更改文件属性。</p>

<p>语法：</p>

<pre><code>chattr [ -RV ] [ -v version ] [ mode ] files...
</code></pre>

<p>最关键的是在<code>[mode]</code>部分，<code>[mode]</code>部分是由<code>+-=</code>和<code>[ASacDdIijsTtu]</code>这些字符组合的，这部分是用来控制文件的:</p>

<ul>
  <li><code>+</code>：在原有参数设定基础上，追加参数。</li>
  <li><code>-</code>：在原有参数设定基础上，移除参数。</li>
  <li><code>=</code>：更新为指定参数设定</li>
  <li><code>A</code>：文件或目录的atime(access time)不可被修改(modified)</li>
  <li><code>S</code>：硬盘I/O同步选项，功能类似sync</li>
  <li><strong><code>a</code>：即append，设定该参数后，只能向文件中添加数据，而不能删除，多用于服务器日志文 件安全，只有root才能设定这个属性。</strong></li>
  <li><strong><code>i</code>：设定文件不能被删除、改名、设定链接关系，同时不能写入或新增内容。i参数对于文件 系统的安全设置有很大帮助。</strong></li>
</ul>

<p>最常用的还是<code>a,i</code>,如下将my.log属性改成只能向尾部添加而不能删除：</p>

<pre><code>[root@ ~]# lsattr my.log
-------------e- my.log

[root@ ~]# chattr +a my.log
[root@ ~]# lsattr my.log
-----a-------e- my.log

[root@ ~]# echo "good"&gt;&gt;my.log
[root@ ~]# cat my.log
good
[root@ ~]# echo "job"&gt;&gt;my.log

[root@ ~]# echo "如果我追到你，我就把你嘿嘿嘿"&gt;my.log
-bash: my.log: Operation not permitted

[root@ ~]# rm my.log
rm: remove regular file `my.log'? y
rm: cannot remove `my.log': Operation not permitted

[root@ ~]# chattr -a my.log
[root@ ~]# rm -f my.log
</code></pre>

<p><strong>你看，设置了<code>a</code>属性，root都干不掉它。但是可以向后追加数据， 如果你<code>vi</code>编辑它也不允许。如果设置了<code>i</code>属性则文件无法写入，更名，删除, 他们对提升系统安全性有很大帮助。</strong></p>

<h2 id="section">查看文件类型</h2>

<p><strong>(1)<code>ls</code>可以通过第一个字符判断文件类型：</strong></p>

<ul>
  <li><code>d</code>代表目录</li>
  <li><code>l</code>：连接文件</li>
  <li><code>b</code>:块文件</li>
  <li><code>c</code>：字符文件</li>
  <li><code>s</code>:socket文件</li>
  <li><code>-</code>:普通文件</li>
  <li><code>p</code>:管道文件</li>
</ul>

<p><strong>(2)<code>file</code>可以直接告诉我们文件类型</strong></p>

<pre><code>[root@ ~]# file install.log
install.log: ASCII text
[root@ ~]# file /usr/bin/aclocal
/usr/bin/aclocal: a /usr/bin/perl -w script text executable
[root@ ~]# file demo/
demo/: directory
</code></pre>

<h2 id="section-1">查找文件</h2>

<p><strong>(1).<code>find</code></strong></p>

<p>之前写过<a href="http://beginman.cn/linux/2015/04/06/Linux-find/"><strong>13个实用的Linux find命令示例</strong></a>,<code>find</code>常用参数如下：</p>

<ul>
  <li><code>-name filename</code>: 按文件名查找</li>
  <li><code>-perm</code>:按文件权限查找</li>
  <li><code>-user username</code>:按用户名查找</li>
  <li><code>-mtime -n/+n</code>:查找n天内/n天前更改过的文件</li>
  <li><code>-atime -n/+n</code>:查找n天内/n天前访问过的文件</li>
  <li><code>-ctime -n/+n</code>:查找n天内/n天前创建过的文件</li>
  <li><code>-newer filename</code>:查找更改时间比filename新的文件</li>
  <li><code>-type b/d/c/p/l/f/s</code>: 按文件类型查找</li>
  <li><code>-size</code>:按文件大小查找</li>
  <li><code>depth n</code>:最大查找目录深度</li>
</ul>

<p><strong>(2).<code>locate</code></strong></p>

<p>数据库查找，比<code>find</code>块，但是或许没有find准确，因为linux每天会同步系统所有文件，对于未同步的文件则查不到，但可以使用<code>updatedb</code>同步，个人建议还是用<code>find</code>更加强大些。</p>

<p><strong>(3).<code>which/whereis</code> 查找执行文件</strong></p>

<pre><code>[root@ ~]# which passwd
/usr/bin/passwd

[root@ ~]# whereis passwd
passwd: /usr/bin/passwd /etc/passwd /usr/share/man/man1/passwd.1.gz
</code></pre>

<p><code>which</code>从系统PATH变量所定义的目录来查找可执行文件的绝对路径，<code>whereis</code>不仅如此还可查找对应的man文件。</p>

<h2 id="section-2">文件系统</h2>

<ul>
  <li>树形文件存储结构</li>
  <li>VFS(Virtual File System, 文件系统+虚拟文件系统， 因为linux任何数据都是0，1格式，为了实现上面的目录+文件树形结构形式，linux采用VFS方案)</li>
  <li>磁盘分区，创建文件系统，挂载等操作</li>
</ul>

<h1 id="section-3">三.字符处理</h1>

<h2 id="section-4">管道</h2>
<p>管道如同水管一样，有大小，linux管道固定大小缓冲区，为1页(4k字节)，管道是一种使用非常频繁的<strong>通信机制</strong>，可以用管道符<code>|</code>连接进程，常用来作为接收数据管道命令有：sed,awk,cut,head,top,less,more,wc,join,sort,split 等等，都是些文本处理命令。</p>

<p>推荐阅读：<a href="http://www.cnblogs.com/chengmo/archive/2010/10/21/1856577.html"><strong>linux shell 管道命令(pipe)使用及与shell重定向区别</strong></a></p>

<h2 id="grep">grep搜索</h2>
<p><code>grep</code>如果匹配到信息则会打印符合条件的所有行</p>

<pre><code>grep [-icnv] '需要匹配的字符' 文件名

-i:不区分大小写
-c:统计包含匹配的行数
-n:输出行号
-v:反向匹配
</code></pre>

<p>如匹配<code>install.log</code>文件：</p>

<pre><code># 匹配安装成功的项目
$ grep -in 'installing' install.log
191:Installing acl-2.2.49-6.el6.x86_64
192:Installing attr-2.4.44-7.el6.x86_64

# 匹配安装失败的项目
$ grep -inv 'installing' install.log
2:warning: libgcc-4.4.7-4.el6.x86_64
</code></pre>

<h2 id="sort">sort排序</h2>

<p><code>sort</code>对数据进行排序：</p>

<pre><code>sort [-ntkr] 文件名
-n:采用数字排序
-t:指定分隔符
-k:指定第几列
-r:反序
</code></pre>

<p>如下：</p>

<pre><code>➜  ~  cat sort.txt 
b:10
d:2
a:20
c:1
f:4

➜  ~  sort sort.txt 
a:20
b:10
c:1
d:2
f:4
</code></pre>

<p><code>sort</code>默认按第一列正序排列</p>

<pre><code># -t指定冒号分隔符，-k用于指定排序的列，-n指明用数字排序
➜  ~  cat sort.txt|sort -t ':' -k 2 -n
c:1
d:2
f:4
b:10
a:20	
</code></pre>

<h2 id="uniq">uniq删除重复</h2>

<p><code>uniq</code>语法如下：</p>

<pre><code>uniq [-ic]
-i:忽略大小写
-c:计算重复的行数
</code></pre>

<p>注意：<strong><code>uniq</code>要与<code>sort</code>一起使用才行，先将文件sort(这样相同的内容就能连续排列)，然后在uniq去重。否则不起作用</strong></p>

<h2 id="cut">cut截取文本</h2>
<p>语法如下：</p>

<pre><code>cut -f指定的列 -d'分隔符'

# 按冒号分隔然后打印第二行的数字
➜  ~  cat sort.txt|cut -f2 -d ':'
10
2
20
1
4
# 按冒号分隔然后打印第一行的字符
➜  ~  cat sort.txt|cut -f1 -d ':'
b
d
a
c
f
# 按冒号分隔然后打印第一，二行
➜  ~  cat sort.txt|cut -f1,2 -d ':'
b:10
d:2
a:20
c:1
f:4
</code></pre>

<p>打印多行如： <code>-f1, 6-8</code>打印第一行，和6到8行；<code>-f1-5, 7-10</code>：打印1到5，7到10行</p>

<h2 id="tr">tr文本转换或删除</h2>

<pre><code>#删除冒号
➜  ~  cat sort.txt|tr -d ':'       
b10
d2
a20
c1
f4
#全部转换大写
  ~  cat sort.txt|tr '[a-z]' '[A-Z]' 
B:10
D:2
A:20
C:1
F:4
</code></pre>

<h2 id="paste">paste文本合并</h2>
<p><code>paste</code>用于合并文本，中间用tab隔开，如下：</p>

<pre><code>➜  ~  cat c.txt d.txt 
a
b

1
2

# 合并
➜  ~  paste c.txt d.txt 
a	1
b	2
# 以冒号分隔合并
➜  ~  paste -d ':' c.txt d.txt
a:1
b:2
</code></pre>

<h2 id="split">split分隔大文件</h2>
<p><code>split</code>用来分隔大文件可以按照行数和大小分，如果是二进制文件则没有行的概念则只能按照大小分，实验如下：</p>

<pre><code># 创建几十兆大文件
➜  ~ for i in `seq 1000000`;do echo "goodjobbeginmanhelloworld"&gt;&gt;big.txt;done
# 查看刚才创建的大文件
➜ ~  du -h big.txt                                                           
 	26M	big.txt
</code></pre>

 	# 方式1.按行分，每10000行分隔<br />
 	split -l 100000 big.txt small_each_100000_lines_<br />

 	# 方式2.按大小分，每10兆分隔<br />
 	split -b 10m big.txt small_each_10mb_file<br />

 	# 查看所分<br />
 	➜  ~  du -h small_each_10*<br />
<pre><code>2.5M	small_each_100000_lines_ab
2.5M	small_each_100000_lines_ac
2.5M	small_each_100000_lines_ad
2.5M	small_each_100000_lines_ae
2.5M	small_each_100000_lines_af
2.5M	small_each_100000_lines_ag
2.5M	small_each_100000_lines_ah
2.5M	small_each_100000_lines_ai
2.5M	small_each_100000_lines_aj
2.5M	small_each_100000_lines_ak

10.0M	small_each_10mb_fileaa
10.0M	small_each_10mb_fileab
5.6M	small_each_10mb_fileac
</code></pre>

<h1 id="section-5">四.网络管理</h1>

<h2 id="ifconfig">ifconfig</h2>

<p><img src="http://beginman.qiniudn.com/ifconfig.png" alt="" /></p>

<ul>
  <li>eth0:表示以太网的第一块网卡，是Ethernet的前三个字母， 0表示第一块网卡，第二块则eth1</li>
  <li>Link encap:指封装方式为以太网</li>
  <li>HWaddr:网卡硬件地址(MAC地址)</li>
  <li>inet addr:该网卡当前的IP地址</li>
  <li>Broadcast:广播地址（由系统根据IP和掩码算出来的，一般不需要手工设置）</li>
  <li>Mask：掩码</li>
  <li>UP：说明网卡处于活动状态(UP BROADCAST RUNNING MULTICAST)</li>
  <li>MTU: 代表网卡的最大存储单元，即网卡一次所能传输的最大分包。(MTU:1500)</li>
  <li>RX,TX：分别代表接收和发送的包，如：(RX packets:227365807 errors:0 dropped:0 overruns:0 frame:0)</li>
  <li>collisions:代表发送的冲突数，<strong>如果发现不为0则可能是网络存在故障</strong>（collisions:0）</li>
  <li>txqueuelen：代表传输缓冲区的长度(txqueuelen:1000)</li>
  <li>第二个设备lo表示主机的环回地址，用于本机通信</li>
</ul>

<p><code>ifconfig</code>相关命令：</p>

<pre><code>ifconfig eth0   # 显示具体设备信息
ifconfig eth0 192.168.159.130/24  # 手工指定eth0的IP地址
ifconfig -a     # 显示所有包括不活动的网卡信息
ifconfig eth0 down/up    # 断开和启动eth0网卡，等同于：ifdown eth0/ifup eth0
</code></pre>

<h2 id="section-6">常见网络故障排查</h2>
<p>网络故障分两种：</p>

<ul>
  <li>硬件故障：网卡损坏(电子元件)，链路故障(网线或水晶头)等</li>
  <li>软件故障：网卡驱动故障等</li>
</ul>

<p>排查步骤如下：</p>

<ol>
  <li>确认网卡本身是否正常工作：利用<code>ping</code>输入ping 127.0.0.1,换回接口，是TCP/IP协议栈正常工作的前提，如果ping不同则本机TCP/IP协议栈有问题。</li>
  <li>确认是否硬件故障，如果第一步ping通则表示正常</li>
  <li>确认二层网络设备如交换机或HUB是否正常工作： ping 同网段的其他主机</li>
  <li>确认是否ping通网关IP，如果数据包能正常到达网卡则说明主机和本地网络都工作正常</li>
  <li>ping公网IP，确认是否正确设置nat或路由设置</li>
  <li>确认是否ping通公网上的某个域名，ping不通则说明DNS设置有问题</li>
</ol>

<h1 id="section-7">五.进程管理</h1>
<p>思考：</p>

<ul>
  <li>什么是进程？</li>
  <li>进程间的同步与互斥是个什么关系？</li>
  <li>如何查看进程？</li>
  <li>管理进程的命令有哪些？</li>
  <li>怎么去管理进程？</li>
</ul>

<h2 id="section-8">进程理解</h2>
<p>进程是一块很大的面包，一口是吃不下的，需要慢慢消耗。如果去面试的时候，面试官问你如何理解进程？你该怎么回答呢？ 如果是我，我可能会回答<em>进程是操作系统基本的执行单元。</em>，回答的我自己的蒙圈了，如果要理解好进程，可以从以下几个方面入手：</p>

<ol>
  <li>进程？程序？</li>
  <li>应用程序?</li>
  <li>动还是静？</li>
</ol>

<p>好了，上面的关键词我们可以理解进程为：</p>

<ol>
  <li>进程表示程序的一次执行过程；或者，说进程是操作系统当前运行的程序</li>
  <li>进程是应用程序的实例，一个应用程序可能包含N多个进程</li>
  <li>启动进程了，那么进程是“动”的（我们的程序是一个静态的概念），操作系统为每个进程都进行了资源调度和独立内存分配</li>
</ol>

<p>我们上面数进程是“动”的，这只是宏观上的，进程也有状态，如下：</p>

<ul>
  <li>运行态： 表示程序当前实际占用着CPU等资源</li>
  <li>就绪态： 表示除CPU外一切运行资源都已经就绪，等待操作系统分配CPU资源，一旦分配了CPU资源则即可运行</li>
  <li>阻塞态： 表示程序员运行过程中由于需要请求外部资源（如I/O资源，打印机等低速的或同一时刻只能独享的资源）而当前无法继续执行，从而主动放弃当前CPU资源转而等待所请求的资源。</li>
</ul>

<h2 id="section-9">同步与互斥</h2>
<p>同步，互斥是进程间的两大关系。从两者语义上就明白它们是什么关系：</p>

<ul>
  <li>互斥：进程间不能同时运行，必须等待一个进程运行完毕另一个进程才能运行，如一些临界资源。</li>
  <li>同步：通过某种通信机制实现信息交互</li>
</ul>

<h2 id="section-10">进程查看</h2>
<p>涉及<code>ps</code>,<code>top</code>命令</p>

<p><img src="http://beginman.qiniudn.com/linux-ps.png" alt="" /></p>

<h2 id="section-11">进程操作</h2>

<h3 id="killkillall">(1) <code>kill</code>,<code>killall</code>命令杀死进程</h3>

<pre><code>kill [信号代码] 进程ID
</code></pre>

<p>常用信号代码：</p>

<ul>
  <li>HUP(1)：重启(软重启，不会改变主进程的PID)</li>
  <li>KILL(9)：强制删掉(直接被系统终止，而没有清理之前申请的内存，这会造成一定的内存泄露)</li>
  <li>TERM(15)：正常结束(是linux默认的中断信号，使进程正常退出)</li>
</ul>

<p>如果不想用进程ID，还可以使用进程名，则使用<code>killall</code>命令：</p>

<pre><code>killall 进程名
</code></pre>

<p>如停止系统中所有的httpd进程，<code>killall httpd</code>, 该命令不仅简单而且更加安全。</p>

<h3 id="lsof">(2) <code>lsof</code>查看进程打开的文件</h3>
<p><code>lsof</code>是list open files的缩写，列出所有打开的文件的工具(Linux一切皆文件)</p>

<p><img src="http://beginman.qiniudn.com/lsof-linux.png" alt="" /></p>

<h3 id="nicerenice">(3) <code>nice</code>,<code>renice</code>调整进程优先级</h3>
<p>在<code>top</code>对应NI字段，标记了对应进程的优先级，数值越低优先级越高；RP字段也表示优先级，其实Linux使用动态优先级，即一个进程的最终优先级=优先级+nice优先级</p>

<pre><code>#nice用于启动进程时赋予优先级
nice -n -10 ./myjob.sh

#renice用于已经启动过的进程，如更改PID为5555的进程
renice -10 -p 5555
</code></pre>

<p>修改优先级的方法有很多，这里仅列出两个。</p>

<h1 id="section-12">六.软件安装</h1>
<p>Linux下软件安装主要还是针对不同的发行版本的不同安装方式，但源码安装时通用的，这里以Centos为例。</p>

<h2 id="section-13">源码包编译安装</h2>
<p>在源码安装过程中往往涉及到环境变量，最通用的方法则是：</p>

<pre><code>echo "export PATH=$PATH:/mypath" &gt;&gt; /etc/rc.local
</code></pre>

<p>源码编译安装的过程如下：（针对模块化，如果是简单的则直接编译安装）：</p>

<ol>
  <li>运行configure命令，结合参数生成Makefile</li>
  <li>运行make命令生成各类模块和主程序</li>
  <li>运行make install 将必要的文件复制到安装目录中</li>
</ol>

<p>之前写过<a href="http://beginman.cn/operation/2015/09/07/make/"><strong>make,make install命令</strong></a></p>

<h2 id="rpm">RPM安装软件</h2>
<p>源码安装有很大的弊端，如下：</p>

<ul>
  <li>繁琐，不安全</li>
  <li>耗时长</li>
  <li>无法完成软件管理如安装，卸载，升级等</li>
</ul>

<p>为了解决此类问题，RedHat采用了<strong>RPM(RedHat Package Manager)包管理机制</strong>,通过<code>rpm</code>命令管理，如下：</p>

<p><img src="http://beginman.qiniudn.com/rpm-linux.png" alt="" /></p>

<p>常用操作：</p>

<pre><code>#install
rpm -ivh package.rpm

#测试软件安装包，不做真实安装
rpm -ivh --test package.rpm

#安装软件包，并重新定义安装路径
rpm -ivh --relocate /=/usr/local/package.rpm

#强行安装并忽略依赖关系
rpm -ivh package.rpm --force --nodeps

#升级软件包
rpm -Uvh package.rpm

#强行升级并忽略依赖关系
rpm -Uvh package.rpm --force --nodeps

#删除软件包，并忽略依赖关系
rpm -e PAKCAGE_NAME --nodeps   # 只是包名，不需要跟版本号

#导入签名
rpm --import RPM-GPG-KEY

#查询某个包是否安装
rpm -q PAKCAGE_NAME

#列出所有已安装的包
rpm -qa

#查询某个文件属于哪个包
rpm -qf /etc/auto.misc

#查询某个已安装软件包含的所有文件
rpm -ql PAKCAGE_NAME

#查询某个包的依赖关系
rpm -qpR PAKCAGE_NAME-VSERSION.rpm

#查询某个包的信息
rpm -qpi PAKCAGE_NAME-VSERSION.rpm

#删除软件包
rpm -e PAKCAGE_NAME
</code></pre>

<h2 id="yum">yum安装</h2>
<p>yum(Yellow dog Updater, Modified, 基于RPM的Shell前端包管理器) 能够从指定服务器安装，删除，升级软件，最大的好处是<strong>自动解决依赖关系</strong>。<br />
	yum [options] [command] [package …]</p>

<pre><code>其中的[options]是可选的:
	选项包括-h（帮助）
	-y（当安装过程提示选择全部为"yes"）
	-q（不显示安装的过程）等
[command]为所要进行的操作
[package ...]是操作的对象
</code></pre>

<h1 id="vim">七. vim</h1>
<p>之前总结过<a href="http://beginman.cn/linux/2015/04/07/vim-learn/"><strong>vim学习</strong></a>,作为基础学习，深入学习的话<a href="http://book.douban.com/subject/25869486/">《Vim实用技巧》</a>是一本不错的好书，这里列出之前没有总结过的。</p>

<p>vim多行编辑：</p>

<p><code>ctrl+v</code>组合键进入<code>—VISUAL BLOCK—</code>模式，可以通过<code>hjkl</code>方向键选择，可以使用一次性的对选中进行删除(d),复制(y),粘贴(p).</p>

<p>vim编辑多个文件：</p>

<p>vim a.txt b.txt c.txt …. 编辑多个文件，但是默认显示第一个，按<code>:n</code>切换下一个(先得save文件后)，按<code>:N</code>回到上一个，按<code>:files</code>查看打开多少个文件。</p>

<h1 id="section-14">八. 正则表达式</h1>

<p>(1). <code>.</code>:点符号匹配除换行符以外的任意一个字符，<code>r.t</code>匹配rot,rit,但非root，<code>r..t</code>匹配root,tddt.</p>

<p>(2). <code>*</code>:星号匹配0次或多次，如ab*,匹配ab,abc,abcd.., <code>r.*t</code>则匹配包含r的任意长度字符再后紧跟一个t,如： Services:/var/root:/usr/bin/false</p>

<p>(3). <code>\{n,m\}</code>解析</p>

<pre><code>`\{n\}`匹配前面的字符n次，如：匹配root：
➜  wx  grep 'ro\{2\}t' /etc/passwd
root:*:0:0:System Administrator:/var/root:/bin/sh
daemon:*:1:1:System Services:/var/root:/usr/bin/false
_cvmsroot:*:212:212:CVMS Root:/var/empty:/usr/bin/false
</code></pre>

<p>(4). <code>\{n,\}</code>:匹配前面的字符至少n次，包含n</p>

<p>(5). <code>\{n,m\}</code>:匹配前面字符n到m次</p>

<pre><code>➜  wx  grep 'ro\{1,2\}t' /etc/passwd
root:*:0:0:System Administrator:/var/root:/bin/sh
daemon:*:1:1:System Services:/var/root:/usr/bin/false
_uucp:*:4:4:Unix to Unix Copy Protocol:/var/spool/uucp:/usr/sbin/uucico
_cvmsroot:*:212:212:CVMS Root:/var/empty:/usr/bin/false
</code></pre>

<p>(6). <code>^</code>:匹配开头，<code>$</code>匹配尾部，<code>^$</code>匹配空。如匹配以r开头，以h结尾，中间任意字符串：</p>

<pre><code>➜  wx  grep '^r.*h$' /etc/passwd
root:*:0:0:System Administrator:/var/root:/bin/sh
</code></pre>

<p>(7). <code>[]</code>匹配任意出现在方括号中的任一字符，如：</p>

<pre><code>- 匹配所有字母：[A-Za-z]
- 配合`^`取反，如[^A-D]匹配不是A到D
- 匹配手机号，^1[38][0-9]\{9\}
</code></pre>

<p>(8). <code>\</code>转义，如<code>[-]</code>就要写成<code>[\\-]</code></p>

<p>(9). <code>\&lt;</code>，<code>\&gt;</code>分别用来界定单词左边界和右边界，如<code>\&lt;hello</code>:匹配以hello开头单词，<code>hello\&gt;</code>以此结尾，<code>\&lt;hello\&gt;</code>精确匹配hello</p>

<pre><code>➜  wx  cat a.txt
hello
helloworld
hello world
➜  wx  grep '\&lt;hello' a.txt
hello
helloworld
hello world
➜  wx  grep 'hello\&gt;' a.txt
hello
hello world
➜  wx  grep '\&lt;hello\&gt;' a.txt
hello
hello world
</code></pre>

<p>(10). <code>\d</code>匹配数字</p>

<p>(11). <code>\b</code>匹配单词边界，如<code>\bhello\b</code>精确匹配hello,同[7]</p>

<p>(12). <code>\B</code>匹配非单词边界，如<code>hello\B</code>可匹配helloworld中的hello</p>

<p>(13). <code>\w</code>匹配字母，数字，下划线，同[A-Za-z0-9]</p>

<p>(14). <code>\W</code>匹配非…，同[^A-Za-z0-9]</p>

<p>(15). <code>\n</code>匹配一个换行符</p>

<p>(16). <code>\r</code>匹配一个回车符</p>

<p>(17). <code>\s</code>匹配空白，S则匹配非空白</p>

<p>(18). <code>?</code>:匹配前一个字符0或1次，如<code>ro?t</code>—&gt;root,rot</p>

<p>(19). <code>+</code>…1次以上，<code>ro+t</code>-&gt;<code>rot</code>,<code>root</code></p>

<p>(20). <code>|</code>或</p>



                <hr>

                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/tools/2015/12/06/Markdown-notepad/" data-toggle="tooltip" data-placement="top" title="Markdown在Notepad++中的使用体验">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/python/2015/12/11/Learning-Python-BeautifulSoup/" data-toggle="tooltip" data-placement="top" title="Learning Python BeautifulSoup">Next Post &rarr;</a>
                    </li>
                    
                </ul>


                

                

            </div>

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#linux基础" title="linux基础" rel="14">
                                    linux基础
                                </a>
                            
        				
                            
                				<a href="/tags/#Python" title="Python" rel="20">
                                    Python
                                </a>
                            
        				
                            
                				<a href="/tags/#linux服务器" title="linux服务器" rel="10">
                                    linux服务器
                                </a>
                            
        				
                            
                				<a href="/tags/#Mysql" title="Mysql" rel="11">
                                    Mysql
                                </a>
                            
        				
                            
                				<a href="/tags/#OS System" title="OS System" rel="7">
                                    OS System
                                </a>
                            
        				
                            
                				<a href="/tags/#python技巧" title="python技巧" rel="21">
                                    python技巧
                                </a>
                            
        				
                            
                				<a href="/tags/#redis" title="redis" rel="14">
                                    redis
                                </a>
                            
        				
                            
                				<a href="/tags/#django" title="django" rel="8">
                                    django
                                </a>
                            
        				
                            
                				<a href="/tags/#tornado" title="tornado" rel="6">
                                    tornado
                                </a>
                            
        				
                            
                				<a href="/tags/#Shell" title="Shell" rel="7">
                                    Shell
                                </a>
                            
        				
                            
                				<a href="/tags/#git" title="git" rel="5">
                                    git
                                </a>
                            
        				
                            
                				<a href="/tags/#web开发" title="web开发" rel="2">
                                    web开发
                                </a>
                            
        				
                            
                				<a href="/tags/#jQuery" title="jQuery" rel="3">
                                    jQuery
                                </a>
                            
        				
                            
                				<a href="/tags/#人生" title="人生" rel="4">
                                    人生
                                </a>
                            
        				
                            
                				<a href="/tags/#备份" title="备份" rel="2">
                                    备份
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Nginx" title="Nginx" rel="3">
                                    Nginx
                                </a>
                            
        				
                            
                				<a href="/tags/#windows服务器" title="windows服务器" rel="3">
                                    windows服务器
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#python模块" title="python模块" rel="2">
                                    python模块
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#运维" title="运维" rel="4">
                                    运维
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#python奇技淫巧" title="python奇技淫巧" rel="4">
                                    python奇技淫巧
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#python" title="python" rel="17">
                                    python
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Unix网络编程" title="Unix网络编程" rel="7">
                                    Unix网络编程
                                </a>
                            
        				
                            
                				<a href="/tags/#C" title="C" rel="2">
                                    C
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#ops" title="ops" rel="3">
                                    ops
                                </a>
                            
        				
                            
                				<a href="/tags/#book" title="book" rel="4">
                                    book
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#mongodb" title="mongodb" rel="6">
                                    mongodb
                                </a>
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/stevensia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Steven's Blog 2016
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
        hljs.initHighlightingOnLoad();
    })
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
