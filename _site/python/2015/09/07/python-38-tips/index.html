<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ä¸ªäººæŠ€æœ¯æ€»ç»“ï¼Œè¯»ä¹¦ç¬”è®°ï¼Œå¿ƒå¾—ç­‰ | è¿™é‡Œæ˜¯ Stevensiaçš„ä¸ªäººåšå®¢ï¼Œä¸å›å…±å‹‰ã€‚">
    <meta name="keyword"  content="Python, Stevençš„åšå®¢, Steven Blog, linux">
    <link rel="shortcut icon" href="img/favicon.ico">

    <title>38ä¸ªpythonæ•°æ®ç±»å‹å°æŠ€å·§ - Steven's Blog!</title>

    <link rel="canonical" href="http://universus.cn/python/2015/09/07/python-38-tips/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Steven's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About me</a>
                    </li>
                    
                    <li>
                        <a href="/portfolio/">Portfolio</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/bigshows/coding1.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/bigshows/coding1.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-9 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#pythonå¥‡æŠ€æ·«å·§" title="pythonå¥‡æŠ€æ·«å·§">pythonå¥‡æŠ€æ·«å·§</a>
                        
                    </div>
                    <h1>38ä¸ªpythonæ•°æ®ç±»å‹å°æŠ€å·§</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by Steven's Blog on September 7, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-9 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<p>æ‘˜è‡ª<a href="http://sahandsaba.com/thirty-python-language-features-and-tricks-you-may-not-know.html">30 Python Language Features and Tricks You May Not Know About</a>, å…¶ä¸­ä¸€äº›çŸ¥è¯†ç‚¹æˆ‘åŠ äº†é‡Šä¹‰å’Œå‚è€ƒï¼Œenjoy ğŸ˜Š.</p>

<p><img src="http://beginman.qiniudn.com/Python-tips-trics-hacks-for-web-application-development.jpg" alt="" /></p>

<h1 id="unpacking">1.Unpacking</h1>

<pre><code>&gt;&gt;&gt; a, b, c = 1, 2, 3
&gt;&gt;&gt; a, b, c
(1, 2, 3)
&gt;&gt;&gt; a, b, c = [1, 2, 3]
&gt;&gt;&gt; a, b, c
(1, 2, 3)
&gt;&gt;&gt; a, b, c = (2 * i + 1 for i in range(3))
&gt;&gt;&gt; a, b, c
(1, 3, 5)
&gt;&gt;&gt; a, (b, c), d = [1, (2, 3), 4]
&gt;&gt;&gt; a
1
&gt;&gt;&gt; b
2
&gt;&gt;&gt; c
3
&gt;&gt;&gt; d
4
</code></pre>

<h1 id="unpacking-for-swapping-variables">2.Unpacking for swapping variables</h1>

<pre><code>&gt;&gt;&gt; a, b = 1, 2
&gt;&gt;&gt; a, b = b, a
&gt;&gt;&gt; a, b
(2, 1)
</code></pre>

<h1 id="extended-unpacking-python-3-only">3. Extended unpacking (Python 3 only)</h1>

<pre><code>&gt;&gt;&gt; a, *b, c = [1, 2, 3, 4, 5]
&gt;&gt;&gt; a
1
&gt;&gt;&gt; b
[2, 3, 4]
&gt;&gt;&gt; c
5
</code></pre>

<h1 id="negative-indexing">4.Negative indexing</h1>

<pre><code>&gt;&gt;&gt; a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[-1]
10
&gt;&gt;&gt; a[-3]
8
</code></pre>

<h1 id="list-slices-astartend">5.List slices (a[start:end])</h1>

<pre><code>&gt;&gt;&gt; a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[2:8]
[2, 3, 4, 5, 6, 7]
</code></pre>

<h1 id="list-slices-with-negative-indexing">6.List slices with negative indexing</h1>

<pre><code>&gt;&gt;&gt; a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[-4:-2]
[7, 8]
</code></pre>

<h1 id="list-slices-with-step-astartendstep">7.List slices with step (a[start:end:step])</h1>

<pre><code>&gt;&gt;&gt; a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[::2]
[0, 2, 4, 6, 8, 10]
&gt;&gt;&gt; a[::3]
[0, 3, 6, 9]
&gt;&gt;&gt; a[::-1]
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
&gt;&gt;&gt; a[2:8:2]
[2, 4, 6]
</code></pre>

<p>è¿™é‡Œå°±å‘è§‰å¾ˆå¥‡æ€ªäº†ï¼Œåˆ‡ç‰‡æ“ä½œï¼Œ<code>a[start:end:step]</code>, å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š<br />
- <code>start</code>:ç¬¬ä¸€ä¸ªå…ƒç´ å¯¹è±¡ï¼Œæ­£ç´¢å¼•ä½ç½®é»˜è®¤ä¸º0ï¼›è´Ÿç´¢å¼•ä½ç½®é»˜è®¤ä¸º <code>-len(seq)</code><br />
- <code>end</code>: æœ€åä¸€ä¸ªå…ƒç´ å¯¹è±¡ï¼Œæ­£ç´¢å¼•ä½ç½®é»˜è®¤ä¸º <code>len(seq)</code>ï¼1ï¼›è´Ÿç´¢å¼•ä½ç½®é»˜è®¤ä¸º -1<br />
- <code>step</code>ï¼šæ­¥é•¿ï¼Œé»˜è®¤ä¸º1ï¼Œæ­¥é•¿å€¼ä¸èƒ½ä¸º0ã€‚</p>

<p>å¦‚æœç´¢å¼•ä¸ºæ­£ï¼Œåˆ™ä»å·¦è‡³å³å–å€¼ï¼Œå¦‚:</p>

<pre><code>&gt;&gt;&gt; a[1:5:2]
[1, 3]
&gt;&gt;&gt; a[1:5:1]
[1, 2, 3, 4]
&gt;&gt;&gt; a[1:5:]
[1, 2, 3, 4]
</code></pre>

<p>å¦‚æœä¸ºè´Ÿï¼Œåˆ™ä»å³å¾€å·¦ï¼Œ</p>

<pre><code>&gt;&gt;&gt; a[-10:-6:2]
[1, 3]
</code></pre>

<p>å…¶ä¸­ï¼Œä¸‰è€…éƒ½å¯ä»¥çœç•¥ï¼š</p>

<pre><code>&gt;&gt;&gt; a[::]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[1::]
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[:3:]
[0, 1, 2]
&gt;&gt;&gt; a[::1]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[::2]
[0, 2, 4, 6, 8, 10]
&gt;&gt;&gt; a[-1::]
[10]
&gt;&gt;&gt; a[-3::]
[8, 9, 10]
&gt;&gt;&gt; a[:-1:]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; a[:-3:]
[0, 1, 2, 3, 4, 5, 6, 7]
&gt;&gt;&gt; a[::-1]
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
&gt;&gt;&gt; 
</code></pre>

<p>æ›´è¿‡åˆ‡ç‰‡çš„çŸ¥è¯†å¯å‚è€ƒ:<a href="http://beginman.cn/pythonæŠ€å·§/2015/04/09/python-splice/">ç†è§£pythonåºåˆ—ç±»å‹çš„åˆ‡ç‰‡</a></p>

<h1 id="list-slices-with-negative-step">8.List slices with negative step</h1>

<pre><code>&gt;&gt;&gt; a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; a[::-1]
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
&gt;&gt;&gt; a[::-2]
[10, 8, 6, 4, 2, 0]
</code></pre>

<h1 id="list-slice-assignment">9. List slice assignment</h1>

<pre><code>&gt;&gt;&gt; a = [1,2,3,4,5]
&gt;&gt;&gt; a[2:3]
[3]
&gt;&gt;&gt; a[2:3] = [0, 0]
&gt;&gt;&gt; a
[1, 2, 0, 0, 4, 5]
&gt;&gt;&gt; a[2:3] 
[0]
&gt;&gt;&gt; a[2:4]
[0, 0]
&gt;&gt;&gt; a[2:4] = [1,2,3]
&gt;&gt;&gt; a[2:3]
[1]
&gt;&gt;&gt; a[2:4] 
[1, 2]
&gt;&gt;&gt; a
[1, 2, 1, 2, 3, 4, 5]
</code></pre>

<p>è¿™é‡Œå¯¹åˆ‡ç‰‡è¿›è¡Œèµ‹å€¼ï¼Œå¦‚<code>a[2:3]</code>è¿”å›çš„æ˜¯<strong>å¼•ç”¨</strong>ï¼Œæˆ‘ä»¬å¯¹å®ƒèµ‹å€¼ä¼šå½±å“æºåºåˆ—</p>

<pre><code>&gt;&gt;&gt; a[2:4] = ['a', 'b', 'c', 'd']			# å°†['a', 'b', 'c', 'd']èµ‹å€¼ç»™a[2:4]å¼•ç”¨,æ’å…¥è‡³åŸåºåˆ—aä¸­
&gt;&gt;&gt; a
[1, 2, 'a', 'b','c','d' 5]
</code></pre>

<p>åŒç†ï¼Œä¹Ÿå¯ä»¥åˆ é™¤å®ƒä»¬ï¼š</p>

<pre><code>&gt;&gt;&gt; a = [1,2,3,4,5]
&gt;&gt;&gt; a[2:4] = []
&gt;&gt;&gt; a
[1, 2, 5]
</code></pre>

<h1 id="naming-slices-slicestart-end-step">10. Naming slices (slice(start, end, step))</h1>

<pre><code>&gt;&gt;&gt; my = slice(4)
&gt;&gt;&gt; my
slice(None, 4, None)
&gt;&gt;&gt; l = list(range(10))
&gt;&gt;&gt; l
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; l[my]
[0, 1, 2, 3]
&gt;&gt;&gt; slice(5)
slice(None, 5, None)
&gt;&gt;&gt; slice(2)
slice(None, 2, None)
&gt;&gt;&gt; slice(1)
slice(None, 1, None)
&gt;&gt;&gt; slice(-2)
slice(None, -2, None)
&gt;&gt;&gt; slice(3, None)
slice(3, None, None)
&gt;&gt;&gt; slice(1, 3, None)
slice(1, 3, None)
</code></pre>

<p><code>slice(start, end, step)</code> å†…ç½®å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åˆ‡ç‰‡çš„åŸç”Ÿã€‚</p>

<h1 id="iterating-over-list-index-and-value-pairs-enumerate">11. Iterating over list index and value pairs (enumerate)</h1>

<pre><code>&gt;&gt;&gt; a = ['Hello', 'world', '!']
&gt;&gt;&gt; for i, x in enumerate(a):
...     print '{}: {}'.format(i, x)
...
0: Hello
1: world
2: !
</code></pre>

<p>å¯¹äºåˆ—è¡¨ï¼Œ<code>enumerate()</code>è¿”å›ç´¢å¼•å’Œå¯¹åº”çš„å€¼.</p>

<h1 id="iterating-over-dictionary-key-and-value-pairs-dictiteritems">12. Iterating over dictionary key and value pairs (dict.iteritems)</h1>

<pre><code>&gt;&gt;&gt; m = {'a': 1, 'b': 2, 'c': 3, 'd': 4}
&gt;&gt;&gt; for k, v in m.iteritems():
...     print '{}: {}'.format(k, v)
...
a: 1
c: 3
b: 2
d: 4
</code></pre>

<p>å¯¹äºå­—å…¸,<code>dict.iteritems()</code>è¿”å›é”®å€¼å¯¹ã€‚</p>

<p><strong>Note: use dict.items in Python 3.</strong></p>

<h1 id="zipping-and-unzipping-lists-and-iterables">13. Zipping and unzipping lists and iterables</h1>

<pre><code>&gt;&gt;&gt; a = [1,2,3]
&gt;&gt;&gt; b = ['a','b','c']
&gt;&gt;&gt; zip(a, b)
[(1, 'a'), (2, 'b'), (3, 'c')]
&gt;&gt;&gt; s = zip(a, b)
&gt;&gt;&gt; zip(s)
[((1, 'a'),), ((2, 'b'),), ((3, 'c'),)]
&gt;&gt;&gt; zip(*s)			
[(1, 2, 3), ('a', 'b', 'c')]
</code></pre>

<p>zip(a, b)è¿›è¡Œå‹ç¼©ï¼Œ zip(*s)åˆ™æ˜¯è§£å‹</p>

<h1 id="grouping-adjacent-list-items-using-zip">14. Grouping adjacent list items using zip</h1>

<pre><code>&gt;&gt;&gt; a = [1, 2, 3, 4, 5, 6]

&gt;&gt;&gt; # Using iterators
&gt;&gt;&gt; group_adjacent = lambda a, k: zip(*([iter(a)] * k))
&gt;&gt;&gt; group_adjacent(a, 3)
[(1, 2, 3), (4, 5, 6)]
&gt;&gt;&gt; group_adjacent(a, 2)
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; group_adjacent(a, 1)
[(1,), (2,), (3,), (4,), (5,), (6,)]

&gt;&gt;&gt; # Using slices
&gt;&gt;&gt; from itertools import islice
&gt;&gt;&gt; group_adjacent = lambda a, k: zip(*(islice(a, i, None, k) for i in range(k)))
&gt;&gt;&gt; group_adjacent(a, 3)
[(1, 2, 3), (4, 5, 6)]
&gt;&gt;&gt; group_adjacent(a, 2)
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; group_adjacent(a, 1)
[(1,), (2,), (3,), (4,), (5,), (6,)]
</code></pre>

<p>å…³äºzipå¯å‚è€ƒ:<a href="http://www.cnblogs.com/beginman/archive/2013/03/14/2959447.html">Pythoné›¶ç¢çŸ¥è¯†(2):å¼ºå¤§çš„zip</a></p>

<h2 id="section">(1).è¿­ä»£å™¨</h2>
<p>å†…ç½®å‡½æ•°<code>iter()</code>ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡(iterable object)ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªiteratorå¯¹è±¡</p>

<pre><code>&gt;&gt;&gt; x = iter([1, 2, 3])
&gt;&gt;&gt; x
&lt;listiterator object at 0x1004ca850&gt;
&gt;&gt;&gt; x.next()
1
&gt;&gt;&gt; x.next()
2
&gt;&gt;&gt; x.next()
3
&gt;&gt;&gt; x.next()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
StopIteration
</code></pre>

<p>æ¯æ¬¡è°ƒç”¨<code>next()</code>è¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰åˆ™è§¦å‘StopIterationå¼‚å¸¸ï¼Œä¸‹é¢ç”¨ç±»æ¨¡ä»¿<code>xrang()</code>ï¼š</p>

<pre><code>class yrange:
    def __init__(self, n):
        self.i = 0
        self.n = n

    def __iter__(self):
        return self

    def next(self):
        if self.i &lt; self.n:
            i = self.i
            self.i += 1
            return i
        else:
            raise StopIteration()
</code></pre>

<p><code>__iter__</code>æ–¹æ³•ä½¿å¯¹è±¡å¯è¿­ä»£ï¼Œå°±æ˜¯é€šè¿‡è°ƒç”¨<code>iter</code>æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæ­¤å¯¹è±¡åº”è¯¥æœ‰<code>next</code>æ–¹æ³•</p>

<pre><code>&gt;&gt;&gt; y = yrange(3)
&gt;&gt;&gt; y.next()
0
&gt;&gt;&gt; y.next()
1
&gt;&gt;&gt; y.next()
2
&gt;&gt;&gt; y.next()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "&lt;stdin&gt;", line 14, in next
StopIteration
</code></pre>

<p>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨listç­‰å†…ç½®å‡½æ•°:</p>

<pre><code>&gt;&gt;&gt; list(yrange(5))
[0, 1, 2, 3, 4]
&gt;&gt;&gt; sum(yrange(5))
10
</code></pre>

<p>åœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œæ— è®ºæ˜¯å¯è¿­ä»£å’Œè¿­ä»£å™¨æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ³¨æ„<code>__iter__</code>ä¸å¿…æ¯æ¬¡éƒ½è¿”å›<code>self</code>, å¦‚ä¸‹ï¼š</p>

<pre><code>class zrange:
    def __init__(self, n):
        self.n = n

    def __iter__(self):
        return zrange_iter(self.n)

class zrange_iter:
    def __init__(self, n):
        self.i = 0
        self.n = n

    def __iter__(self):
        # Iterators are iterables too.
        # Adding this functions to make them so.
        return self

    def next(self):
        if self.i &lt; self.n:
            i = self.i
            self.i += 1
            return i
        else:
            raise StopIteration()
</code></pre>

<p>å¦‚æœå¯è¿­ä»£å’Œè¿­ä»£å™¨æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä»–ä»¬è¢«æ¶ˆè€—åœ¨å•æ¬¡è¿­ä»£ï¼š</p>

<pre><code>&gt;&gt;&gt; y = yrange(5)
&gt;&gt;&gt; list(y)
[0, 1, 2, 3, 4]
&gt;&gt;&gt; list(y)
[]
&gt;&gt;&gt; z = zrange(5)
&gt;&gt;&gt; list(z)
[0, 1, 2, 3, 4]
&gt;&gt;&gt; list(z)
[0, 1, 2, 3, 4]
</code></pre>

<h2 id="section-1">(2). ç”Ÿæˆå™¨</h2>
<p>ç”Ÿæˆå™¨ç®€åŒ–äº†åˆ›å»ºè¿­ä»£å™¨:</p>

<pre><code>def yrange(n):
    i = 0
    while i &lt; n:
        yield i
        i += 1
</code></pre>

<p>æ¯æ¬¡<code>yield</code>è¯­å¥ç”Ÿæˆä¸€ä¸ªæ–°å€¼ï¼š</p>

<pre><code>&gt;&gt;&gt; y = yrange(3)
&gt;&gt;&gt; y
&lt;generator object yrange at 0x401f30&gt;
&gt;&gt;&gt; y.next()
0
&gt;&gt;&gt; y.next()
1
&gt;&gt;&gt; y.next()
2
&gt;&gt;&gt; y.next()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
StopIteration
</code></pre>

<p>æ‰€ä»¥<strong>ç”Ÿæˆå™¨ä¹Ÿæ˜¯è¿­ä»£å™¨</strong></p>

<pre><code>&gt;&gt;&gt; def foo():
...     print "begin"
...     for i in range(3):
...         print "before yield", i
...         yield i
...         print "after yield", i
...     print "end"
...
&gt;&gt;&gt; f = foo()
&gt;&gt;&gt; f.next()
begin
before yield 0
0
&gt;&gt;&gt; f.next()
after yield 0
before yield 1
1
&gt;&gt;&gt; f.next()
after yield 1
before yield 2
2
&gt;&gt;&gt; f.next()
after yield 2
end
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
StopIteration
&gt;&gt;&gt;
</code></pre>

<p>ä¸‹é¢ä¸€ä¸ªç®—æ³•ï¼Œä½¿ç”¨ç”Ÿæˆå™¨çš„æ–¹å¼è®¡ç®—è¿ç»­nä¸ªå…ƒç´ (0~n, nå¯æ— ç©·å¤§)çš„å¹³æ–¹ï¼š</p>

<pre><code>def integers():
    i = 1
    while 1:
        yield i
        i += 1


def squares():
    for i in integers():
        yield i * i


def take(n, seq):
    result = []
    seq = iter(seq)
    try:
        for i in range(n):
            result.append(seq.next())
    except StopIteration:
        pass
    return result


print take(5, squares()) # prints [1, 4, 9, 16, 25]
</code></pre>

<h2 id="section-2">(3).ç”Ÿæˆå™¨è¡¨è¾¾å¼</h2>
<p>ç”Ÿæˆå™¨è¡¨è¾¾å¼çœ‹èµ·æ¥åƒlistçš„å«ä¹‰ï¼Œä½†è¿”å›çš„æ˜¯ä¸€ä¸ªå¤‡ç”¨çš„ç”Ÿæˆå™¨è€Œéä¸€ä¸ªåˆ—è¡¨.ç‰¹ä¹ˆè¿™å¥è¯â€Generator Expressions are generator version of list comprehensions. They look like list comprehensions, but returns a generator back instead of a list.â€æˆ‘ä¹Ÿä¸å¥½ç†è§£ã€‚ã€‚ã€‚ã€‚</p>

<p><img src="http://beginman.qiniudn.com/funs.png" alt="" /></p>

<pre><code>&gt;&gt;&gt; a = (x for x in range(10))
&gt;&gt;&gt; a
&lt;generator object &lt;genexpr&gt; at 0x103279aa0&gt;
&gt;&gt;&gt; sum(a)
45

&gt;&gt;&gt; a = (x for x in range(10))
&gt;&gt;&gt; a.next()
0
&gt;&gt;&gt; a.next()
1
&gt;&gt;&gt; a.next()
2
&gt;&gt;&gt; sum(a)		# æ³¨æ„ç¼©å‡å•Š
42
</code></pre>

<h2 id="xrange-vs-range">(4).xrange vs range</h2>

<ul>
  <li><code>range</code>: range([start,] stop[, step])ï¼Œæ ¹æ®startä¸stopæŒ‡å®šçš„èŒƒå›´ä»¥åŠstepè®¾å®šçš„æ­¥é•¿ï¼Œç”Ÿæˆä¸€ä¸ªåºåˆ—ã€‚</li>
  <li>
    <p><code>xrange</code>: ç”¨æ³•ä¸rangeå®Œå…¨ç›¸åŒï¼Œæ‰€ä¸åŒçš„æ˜¯ç”Ÿæˆçš„ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ã€‚</p>

    <blockquote>
      <blockquote>
        <blockquote>
          <p>xrange(1,5)<br />
  xrange(1, 5)<br />
list(xrange(1,5))<br />
  [1, 2, 3, 4]</p>
        </blockquote>
      </blockquote>
    </blockquote>
  </li>
</ul>

<p><strong>è¦ç”Ÿæˆå¾ˆå¤§çš„æ•°å­—åºåˆ—çš„æ—¶å€™ï¼Œç”¨xrangeä¼šæ¯”rangeæ€§èƒ½ä¼˜å¾ˆå¤šï¼Œå› ä¸ºä¸éœ€è¦ä¸€ä¸Šæ¥å°±å¼€è¾Ÿä¸€å—å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨å¾ªç¯çš„æ—¶å€™ç”¨</strong></p>

<h2 id="itertoolsislice">(5). itertools.islice</h2>
<p>å‡½æ•°åŸå‹:</p>

<pre><code>itertools.islice(iterable, start, stop[, step])
</code></pre>

<p>è¿”å›çš„è¿­ä»£å™¨æ˜¯è¿”å›äº†è¾“å…¥è¿­ä»£å™¨æ ¹æ®ç´¢å¼•æ¥é€‰å–çš„é¡¹,ç”Ÿæˆé¡¹çš„æ–¹å¼ç±»ä¼¼äºåˆ‡ç‰‡è¿”å›å€¼,ä¸åˆ‡ç‰‡ä¸åŒï¼Œè´Ÿå€¼ä¸ä¼šç”¨äºä»»ä½•startï¼Œstopå’Œstepï¼Œ å¦‚æœçœç•¥äº†startï¼Œè¿­ä»£å°†ä»0å¼€å§‹ï¼Œå¦‚æœçœç•¥äº†stepï¼Œæ­¥å¹…å°†é‡‡ç”¨1.</p>

<pre><code>from itertools import *

print 'Stop at 5:'
for i in islice(count(), 5):
    print i,					# 0,1,2,3,4

print 'Start at 5, Stop at 10:'
for i in islice(count(), 5, 10):
    print i,					# 5,6,7,8,9

print 'By tens to 100:'
for i in islice(count(), 0, 100, 10):
    print i,					# 0,10,20,30,40,50,60,70,80,90
</code></pre>

<p>å†ä¸Šä¸€ä¸ªä¾‹å­ä¸­ï¼Œç”¨äº†é«˜é˜¶å‡½æ•°<code>islice()</code>å®ç°ï¼š</p>

<pre><code>&gt;&gt;&gt; group_adjacent = lambda a, k: zip(*(islice(a, i, None, k) for i in range(k)))
&gt;&gt;&gt; group_adjacent(a, 3)
[(1, 2, 3), (4, 5, 6)]
</code></pre>

<p>ä¹ä¸€çœ‹ä¼šæœ‰ç‚¹å“äººï¼Œæˆ‘ä»¬æ‹†åˆ†æ¥çœ‹ï¼š</p>

<pre><code>&gt;&gt;&gt; s = (islice(range(10), i, None, 3) for i in range(3))			# é€šè¿‡forå¾ªç¯ç”¨isliceåˆ›å»º3ä¸ªè¿­ä»£å™¨ï¼Œç»„æˆäº†ç”Ÿæˆå™¨
&gt;&gt;&gt; for i in s:
...     print i, list(i)
... 
&lt;itertools.islice object at 0x10329b368&gt; [0, 3, 6, 9]			# islice(range(10), 0, None, 3) --ä»0ç´¢å¼•å¼€å§‹æ­¥é•¿ä¸º3-&gt; [0, 3, 6, 9]
&lt;itertools.islice object at 0x10329b260&gt; [1, 4, 7]				# islice(range(10), 1, None, 3) -- ä»1ç´¢å¼•å¼€å§‹æ­¥é•¿ä¸º3-&gt;[1,4,7]
&lt;itertools.islice object at 0x10329b368&gt; [2, 5, 8]				# islice(range(10), 2, None, 3) -- ä»2ç´¢å¼•å¼€å§‹æ­¥é•¿ä¸º3-&gt;[2,5,8]
</code></pre>

<p>é‚£ä¹ˆ<code>zip(*s)</code>è§£å‹, ç”±äºæœ€çŸ­å…ƒç´ ä¸ªæ•°ä¸º3ä¸ªï¼Œåˆ™å…ƒç´ 9ä¼šè¢«è¿‡æ»¤æ‰ï¼š</p>

<pre><code>&gt;&gt;&gt; s = (islice(range(10), i, None, 3) for i in range(3))
&gt;&gt;&gt; zip(*s)
[(0, 1, 2), (3, 4, 5), (6, 7, 8)]
</code></pre>

<h1 id="sliding-windows-n-grams-using-zip-and-iterators">15. Sliding windows (n-grams) using zip and iterators</h1>

<pre><code>&gt;&gt;&gt; from itertools import islice
&gt;&gt;&gt; def n_grams(a, n):
...     z = (islice(a, i, None) for i in range(n))		# è¿™é‡Œæ­¥é•¿ä¸º1
...     return zip(*z)
...
&gt;&gt;&gt; a = [1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; n_grams(a, 3)
[(1, 2, 3), (2, 3, 4), (3, 4, 5), (4, 5, 6)]
&gt;&gt;&gt; n_grams(a, 2)
[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)]
&gt;&gt;&gt; n_grams(a, 4)
[(1, 2, 3, 4), (2, 3, 4, 5), (3, 4, 5, 6)]
</code></pre>

<h1 id="inverting-a-dictionary-using-zip">16. Inverting a dictionary using zip</h1>

<pre><code>&gt;&gt;&gt; m = {'a': 1, 'b': 2, 'c': 3, 'd': 4}
&gt;&gt;&gt; m.items()
[('a', 1), ('c', 3), ('b', 2), ('d', 4)]
&gt;&gt;&gt; zip(m.values(), m.keys())
[(1, 'a'), (3, 'c'), (2, 'b'), (4, 'd')]
&gt;&gt;&gt; mi = dict(zip(m.values(), m.keys()))
&gt;&gt;&gt; mi
{1: 'a', 2: 'b', 3: 'c', 4: 'd'}
</code></pre>

<h1 id="flattening-lists">17. Flattening lists:</h1>

<p>è¿™é‡Œå¼€å§‹å¹³é“ºäº†ï¼Œå…±æœ‰3ç§æ–¹å¼ï¼š<code>itertools.chain.from_iterable</code>, <code>sum</code>, å’Œåˆ—è¡¨æ¨å¯¼</p>

<pre><code>&gt;&gt;&gt; a = [[1, 2], [3, 4], [5, 6]]
&gt;&gt;&gt; list(itertools.chain.from_iterable(a))
[1, 2, 3, 4, 5, 6]

&gt;&gt;&gt; sum(a, [])
[1, 2, 3, 4, 5, 6]

&gt;&gt;&gt; [x for l in a for x in l]
[1, 2, 3, 4, 5, 6]

&gt;&gt;&gt; a = [[[1, 2], [3, 4]], [[5, 6], [7, 8]]]
&gt;&gt;&gt; [x for l1 in a for l2 in l1 for x in l2]
[1, 2, 3, 4, 5, 6, 7, 8]

&gt;&gt;&gt; a = [1, 2, [3, 4], [[5, 6], [7, 8]]]
&gt;&gt;&gt; flatten = lambda x: [y for l in x for y in flatten(l)] if type(x) is list else [x]
&gt;&gt;&gt; flatten(a)
[1, 2, 3, 4, 5, 6, 7, 8]
</code></pre>

<h1 id="generator-expressions">18. Generator expressions</h1>

<pre><code>&gt;&gt;&gt; g = (x ** 2 for x in xrange(10))
&gt;&gt;&gt; next(g)
0
&gt;&gt;&gt; next(g)
1
&gt;&gt;&gt; next(g)
4
&gt;&gt;&gt; next(g)
9
&gt;&gt;&gt; sum(x ** 3 for x in xrange(10))
2025
&gt;&gt;&gt; sum(x ** 3 for x in xrange(10) if x % 3 == 1)
408
</code></pre>

<h1 id="dictionary-comprehensions">19. Dictionary comprehensions</h1>

<pre><code>&gt;&gt;&gt; m = {x: x ** 2 for x in range(5)}
&gt;&gt;&gt; m
{0: 0, 1: 1, 2: 4, 3: 9, 4: 16}

&gt;&gt;&gt; m = {x: 'A' + str(x) for x in range(10)}
&gt;&gt;&gt; m
{0: 'A0', 1: 'A1', 2: 'A2', 3: 'A3', 4: 'A4', 5: 'A5', 6: 'A6', 7: 'A7', 8: 'A8', 9: 'A9'}
</code></pre>

<h1 id="inverting-a-dictionary-using-a-dictionary-comprehension">20. Inverting a dictionary using a dictionary comprehension</h1>

<pre><code>&gt;&gt;&gt; m = {'a': 1, 'b': 2, 'c': 3, 'd': 4}
&gt;&gt;&gt; m
{'d': 4, 'a': 1, 'b': 2, 'c': 3}
&gt;&gt;&gt; {v: k for k, v in m.items()}
{1: 'a', 2: 'b', 3: 'c', 4: 'd'}
</code></pre>

<h1 id="named-tuples-collectionsnamedtuple">21. Named tuples (collections.namedtuple)</h1>

<pre><code>&gt;&gt;&gt; Point = collections.namedtuple('Point', ['x', 'y'])
&gt;&gt;&gt; p = Point(x=1.0, y=2.0)
&gt;&gt;&gt; p
Point(x=1.0, y=2.0)
&gt;&gt;&gt; p.x
1.0
&gt;&gt;&gt; p.y
2.0
</code></pre>

<p>Pythonæ‹¥æœ‰ä¸€äº›å†…ç½®çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚str, int, list, tuple, dictç­‰ï¼Œ <code>collections</code>æ¨¡å—åœ¨è¿™äº›å†…ç½®æ•°æ®ç±»å‹çš„åŸºç¡€ä¸Šï¼Œæä¾›äº†å‡ ä¸ªé¢å¤–çš„æ•°æ®ç±»å‹ï¼š</p>

<ul>
  <li><code>namedtuple()</code>: ç”Ÿæˆå¯ä»¥ä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ å†…å®¹çš„tupleå­ç±»</li>
  <li><code>deque</code>: åŒç«¯é˜Ÿåˆ—ï¼Œå¯ä»¥å¿«é€Ÿçš„ä»å¦å¤–ä¸€ä¾§è¿½åŠ å’Œæ¨å‡ºå¯¹è±¡</li>
  <li><code>Counter</code>: è®¡æ•°å™¨ï¼Œä¸»è¦ç”¨æ¥è®¡æ•°</li>
  <li><code>OrderedDict</code>: æœ‰åºå­—å…¸</li>
  <li><code>defaultdict</code>: å¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸</li>
</ul>

<p>å¯å‚è€ƒ<a href="http://www.zlovezl.cn/articles/collections-in-python/">ä¸å¯ä¸çŸ¥çš„Pythonæ¨¡å—: collections</a></p>

<h1 id="inheriting-from-named-tuples">22. Inheriting from named tuples:</h1>

<pre><code>&gt;&gt;&gt; class Point(collections.namedtuple('PointBase', ['x', 'y'])):
...     __slots__ = ()
...     def __add__(self, other):
...             return Point(x=self.x + other.x, y=self.y + other.y)
...
&gt;&gt;&gt; p = Point(x=1.0, y=2.0)
&gt;&gt;&gt; q = Point(x=2.0, y=3.0)
&gt;&gt;&gt; p + q
Point(x=3.0, y=5.0)
</code></pre>

<h1 id="sets-and-set-operations">23. Sets and set operations</h1>

<pre><code>&gt;&gt;&gt; A = {1, 2, 3, 3}
&gt;&gt;&gt; A
set([1, 2, 3])
&gt;&gt;&gt; B = {3, 4, 5, 6, 7}
&gt;&gt;&gt; B
set([3, 4, 5, 6, 7])
&gt;&gt;&gt; A | B
set([1, 2, 3, 4, 5, 6, 7])
&gt;&gt;&gt; A &amp; B
set([3])
&gt;&gt;&gt; A - B
set([1, 2])
&gt;&gt;&gt; B - A
set([4, 5, 6, 7])
&gt;&gt;&gt; A ^ B
set([1, 2, 4, 5, 6, 7])
&gt;&gt;&gt; (A ^ B) == ((A - B) | (B - A))
True
</code></pre>

<h1 id="multisets-and-multiset-operations-collectionscounter">24. Multisets and multiset operations (collections.Counter)</h1>

<pre><code>&gt;&gt;&gt; A = collections.Counter([1, 2, 2])
&gt;&gt;&gt; B = collections.Counter([2, 2, 3])
&gt;&gt;&gt; A
Counter({2: 2, 1: 1})
&gt;&gt;&gt; B
Counter({2: 2, 3: 1})
&gt;&gt;&gt; A | B
Counter({2: 2, 1: 1, 3: 1})
&gt;&gt;&gt; A &amp; B
Counter({2: 2})
&gt;&gt;&gt; A + B
Counter({2: 4, 1: 1, 3: 1})
&gt;&gt;&gt; A - B
Counter({1: 1})
&gt;&gt;&gt; B - A
Counter({3: 1})
</code></pre>

<h1 id="most-common-elements-in-an-iterable-collectionscounte">25. Most common elements in an iterable (collections.Counte</h1>

<pre><code>&gt;&gt;&gt; A = collections.Counter([1, 1, 2, 2, 3, 3, 3, 3, 4, 5, 6, 7])
&gt;&gt;&gt; A
Counter({3: 4, 1: 2, 2: 2, 4: 1, 5: 1, 6: 1, 7: 1})
&gt;&gt;&gt; A.most_common(1)
[(3, 4)]
&gt;&gt;&gt; A.most_common(3)
[(3, 4), (1, 2), (2, 2)]
</code></pre>

<h1 id="double-ended-queue-collectionsdeque">26. Double-ended queue (collections.deque)</h1>

<pre><code>&gt;&gt;&gt; Q = collections.deque()
&gt;&gt;&gt; Q.append(1)
&gt;&gt;&gt; Q.appendleft(2)
&gt;&gt;&gt; Q.extend([3, 4])
&gt;&gt;&gt; Q.extendleft([5, 6])
&gt;&gt;&gt; Q
deque([6, 5, 2, 1, 3, 4])
&gt;&gt;&gt; Q.pop()
4
&gt;&gt;&gt; Q.popleft()
6
&gt;&gt;&gt; Q
deque([5, 2, 1, 3])
&gt;&gt;&gt; Q.rotate(3)
&gt;&gt;&gt; Q
deque([2, 1, 3, 5])
&gt;&gt;&gt; Q.rotate(-3)
&gt;&gt;&gt; Q
deque([5, 2, 1, 3])
</code></pre>

<h1 id="double-ended-queue-with-maximum-length-collectionsdeque">27. Double-ended queue with maximum length (collections.deque)</h1>

<pre><code>&gt;&gt;&gt; last_three = collections.deque(maxlen=3)
&gt;&gt;&gt; for i in xrange(10):
...     last_three.append(i)
...     print ', '.join(str(x) for x in last_three)
...
0
0, 1
0, 1, 2
1, 2, 3
2, 3, 4
3, 4, 5
4, 5, 6
5, 6, 7
6, 7, 8
7, 8, 9
</code></pre>

<h1 id="ordered-dictionaries-collectionsordereddict">28. Ordered dictionaries (collections.OrderedDict)</h1>

<pre><code>&gt;&gt;&gt; m = dict((str(x), x) for x in range(10))
&gt;&gt;&gt; print ', '.join(m.keys())
1, 0, 3, 2, 5, 4, 7, 6, 9, 8
&gt;&gt;&gt; m = collections.OrderedDict((str(x), x) for x in range(10))
&gt;&gt;&gt; print ', '.join(m.keys())
0, 1, 2, 3, 4, 5, 6, 7, 8, 9
&gt;&gt;&gt; m = collections.OrderedDict((str(x), x) for x in range(10, 0, -1))
&gt;&gt;&gt; print ', '.join(m.keys())
10, 9, 8, 7, 6, 5, 4, 3, 2, 1
</code></pre>

<h1 id="default-dictionaries-collectionsdefaultdict">29. Default dictionaries (collections.defaultdict)</h1>

<pre><code>&gt;&gt;&gt; m = dict()
&gt;&gt;&gt; m['a']
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
KeyError: 'a'
&gt;&gt;&gt;
&gt;&gt;&gt; m = collections.defaultdict(int)
&gt;&gt;&gt; m['a']
0
&gt;&gt;&gt; m['b']
0
&gt;&gt;&gt; m = collections.defaultdict(str)
&gt;&gt;&gt; m['a']
''
&gt;&gt;&gt; m['b'] += 'a'
&gt;&gt;&gt; m['b']
'a'
&gt;&gt;&gt; m = collections.defaultdict(lambda: '[default value]')
&gt;&gt;&gt; m['a']
'[default value]'
&gt;&gt;&gt; m['b']
'[default value]'
</code></pre>

<h1 id="using-default-dictionaries-to-represent-simple-trees">30. Using default dictionaries to represent simple trees</h1>

<pre><code>&gt;&gt;&gt; import json
&gt;&gt;&gt; tree = lambda: collections.defaultdict(tree)
&gt;&gt;&gt; root = tree()
&gt;&gt;&gt; root['menu']['id'] = 'file'
&gt;&gt;&gt; root['menu']['value'] = 'File'
&gt;&gt;&gt; root['menu']['menuitems']['new']['value'] = 'New'
&gt;&gt;&gt; root['menu']['menuitems']['new']['onclick'] = 'new();'
&gt;&gt;&gt; root['menu']['menuitems']['open']['value'] = 'Open'
&gt;&gt;&gt; root['menu']['menuitems']['open']['onclick'] = 'open();'
&gt;&gt;&gt; root['menu']['menuitems']['close']['value'] = 'Close'
&gt;&gt;&gt; root['menu']['menuitems']['close']['onclick'] = 'close();'
&gt;&gt;&gt; print json.dumps(root, sort_keys=True, indent=4, separators=(',', ': '))
{
    "menu": {
        "id": "file",
        "menuitems": {
            "close": {
                "onclick": "close();",
                "value": "Close"
            },
            "new": {
                "onclick": "new();",
                "value": "New"
            },
            "open": {
                "onclick": "open();",
                "value": "Open"
            }
        },
        "value": "File"
    }
}
</code></pre>

<h1 id="mapping-objects-to-unique-counting-numbers-collectionsdefaultdict">31. Mapping objects to unique counting numbers (collections.defaultdict)</h1>

<pre><code>&gt;&gt;&gt; import itertools, collections
&gt;&gt;&gt; value_to_numeric_map = collections.defaultdict(itertools.count().next)
&gt;&gt;&gt; value_to_numeric_map['a']
0
&gt;&gt;&gt; value_to_numeric_map['b']
1
&gt;&gt;&gt; value_to_numeric_map['c']
2
&gt;&gt;&gt; value_to_numeric_map['a']
0
&gt;&gt;&gt; value_to_numeric_map['b']
1
&gt;&gt;&gt;value
defaultdict(&lt;method-wrapper 'next' of itertools.count object at 0x1094cdb00&gt;,
        {'a': 0, 'b': 1, 'c': 2, 'd': 3})
</code></pre>

<p>ä¸Šé¢è¿™å‡ éƒ¨åˆ†ç”¨çš„äº†<code>collections</code>æ¨¡å—ï¼Œå…³äºæ­¤æ¨¡å—å‚è€ƒè¿™é‡Œå§ï¼š<a href="http://beginman.cn/python/2015/09/07/collections/">Python collectionsæ¨¡å—</a></p>

<h1 id="largest-and-smallest-elements-heapqnlargest-and-heapqnsmallest">32. Largest and smallest elements (heapq.nlargest and heapq.nsmallest)</h1>

<pre><code>&gt;&gt;&gt;import random, heapq
&gt;&gt;&gt;a = [random.randint(0, 100) for __ in xrange(100)]
&gt;&gt;&gt; heapq.nsmallest(5, a)		# 5ä¸ªæœ€å°å…ƒç´ 
[0, 2, 4, 6, 8]
&gt;&gt;&gt; heapq.nlargest(5, a)		# 5ä¸ªæœ€å¤§å…ƒç´ 
[100, 100, 98, 96, 95]
</code></pre>

<h1 id="cartesian-products-itertoolsproduct">33. Cartesian products (itertools.product)</h1>

<pre><code>&gt;&gt;&gt; for p in itertools.product([1, 2, 3], [4, 5]):
(1, 4)
(1, 5)
(2, 4)
(2, 5)
(3, 4)
(3, 5)
&gt;&gt;&gt; for p in itertools.product([0, 1], repeat=4):
...     print ''.join(str(x) for x in p)
...
0000
0001
0010
0011
0100
0101
0110
0111
1000
1001
1010
1011
1100
1101
1110
1111
</code></pre>

<h1 id="combinations-and-combinations-with-replacement-itertoolscombinations-and-itertoolscombinationswithreplacement">34.Combinations and combinations with replacement (itertools.combinations and itertools.combinations_with_replacement)</h1>

<pre><code>In [48]: for i in itertools.combinations([1,2,3,4,5], 3):
   ....:     print i
   ....:     
(1, 2, 3)
(1, 2, 4)
(1, 2, 5)
(1, 3, 4)
(1, 3, 5)
(1, 4, 5)
(2, 3, 4)
(2, 3, 5)
(2, 4, 5)
(3, 4, 5)


In [51]: for c in itertools.combinations_with_replacement([1,2,3,4,5], 3):
print c
   ....:     
(1, 1, 1)
(1, 1, 2)
(1, 1, 3)
(1, 1, 4)
(1, 1, 5)
(1, 2, 2)
(1, 2, 3)
(1, 2, 4)
(1, 2, 5)
(1, 3, 3)
(1, 3, 4)
(1, 3, 5)
(1, 4, 4)
(1, 4, 5)
(1, 5, 5)
(2, 2, 2)
(2, 2, 3)
(2, 2, 4)
(2, 2, 5)
(2, 3, 3)
(2, 3, 4)
(2, 3, 5)
(2, 4, 4)
(2, 4, 5)
(2, 5, 5)
(3, 3, 3)
(3, 3, 4)
(3, 3, 5)
(3, 4, 4)
(3, 4, 5)
(3, 5, 5)
(4, 4, 4)
(4, 4, 5)
(4, 5, 5)
(5, 5, 5)
</code></pre>

<h1 id="permutations-itertoolspermutations">35. Permutations (itertools.permutations)</h1>

<pre><code>In [52]: for i in itertools.permutations([1,2,3,4]):
   ....:     print i
   ....:     
(1, 2, 3, 4)
(1, 2, 4, 3)
(1, 3, 2, 4)
(1, 3, 4, 2)
(1, 4, 2, 3)
(1, 4, 3, 2)
(2, 1, 3, 4)
(2, 1, 4, 3)
(2, 3, 1, 4)
(2, 3, 4, 1)
(2, 4, 1, 3)
(2, 4, 3, 1)
(3, 1, 2, 4)
(3, 1, 4, 2)
(3, 2, 1, 4)
(3, 2, 4, 1)
(3, 4, 1, 2)
(3, 4, 2, 1)
(4, 1, 2, 3)
(4, 1, 3, 2)
(4, 2, 1, 3)
(4, 2, 3, 1)
(4, 3, 1, 2)
(4, 3, 2, 1)
</code></pre>

<h1 id="chaining-iterables-itertoolschain">36. Chaining iterables (itertools.chain)</h1>

<pre><code>&gt;&gt;&gt; a = [1, 2, 3, 4]
&gt;&gt;&gt; for p in itertools.chain(itertools.combinations(a, 2), itertools.combinations(a, 3)):
...     print p
...
(1, 2)
(1, 3)
(1, 4)
(2, 3)
(2, 4)
(3, 4)
(1, 2, 3)
(1, 2, 4)
(1, 3, 4)
(2, 3, 4)
&gt;&gt;&gt; for subset in itertools.chain.from_iterable(itertools.combinations(a, n) for n in range(len(a) + 1))
...     print subset
...
()
(1,)
(2,)
(3,)
(4,)
(1, 2)
(1, 3)
(1, 4)
(2, 3)
(2, 4)
(3, 4)
(1, 2, 3)
(1, 2, 4)
(1, 3, 4)
(2, 3, 4)
(1, 2, 3, 4)
</code></pre>

<h1 id="grouping-rows-by-a-given-key-itertoolsgroupby">37. Grouping rows by a given key (itertools.groupby)</h1>

<pre><code>&gt;&gt;&gt; from operator import itemgetter
&gt;&gt;&gt; import itertools
&gt;&gt;&gt; with open('contactlenses.csv', 'r') as infile:
...     data = [line.strip().split(',') for line in infile]
...
&gt;&gt;&gt; data = data[1:]
&gt;&gt;&gt; def print_data(rows):
...     print '\n'.join('\t'.join('{: &lt;16}'.format(s) for s in row) for row in rows)
...

&gt;&gt;&gt; print_data(data)
young               myope                   no                      reduced                 none
young               myope                   no                      normal                  soft
young               myope                   yes                     reduced                 none
young               myope                   yes                     normal                  hard
young               hypermetrope            no                      reduced                 none
young               hypermetrope            no                      normal                  soft
young               hypermetrope            yes                     reduced                 none
young               hypermetrope            yes                     normal                  hard
pre-presbyopic      myope                   no                      reduced                 none
pre-presbyopic      myope                   no                      normal                  soft
pre-presbyopic      myope                   yes                     reduced                 none
pre-presbyopic      myope                   yes                     normal                  hard
pre-presbyopic      hypermetrope            no                      reduced                 none
pre-presbyopic      hypermetrope            no                      normal                  soft
pre-presbyopic      hypermetrope            yes                     reduced                 none
pre-presbyopic      hypermetrope            yes                     normal                  none
presbyopic          myope                   no                      reduced                 none
presbyopic          myope                   no                      normal                  none
presbyopic          myope                   yes                     reduced                 none
presbyopic          myope                   yes                     normal                  hard
presbyopic          hypermetrope            no                      reduced                 none
presbyopic          hypermetrope            no                      normal                  soft
presbyopic          hypermetrope            yes                     reduced                 none
presbyopic          hypermetrope            yes                     normal                  none

&gt;&gt;&gt; data.sort(key=itemgetter(-1))
&gt;&gt;&gt; for value, group in itertools.groupby(data, lambda r: r[-1]):
...     print '-----------'
...     print 'Group: ' + value
...     print_data(group)
...
-----------
Group: hard
young               myope                   yes                     normal                  hard
young               hypermetrope            yes                     normal                  hard
pre-presbyopic      myope                   yes                     normal                  hard
presbyopic          myope                   yes                     normal                  hard
-----------
Group: none
young               myope                   no                      reduced                 none
young               myope                   yes                     reduced                 none
young               hypermetrope            no                      reduced                 none
young               hypermetrope            yes                     reduced                 none
pre-presbyopic      myope                   no                      reduced                 none
pre-presbyopic      myope                   yes                     reduced                 none
pre-presbyopic      hypermetrope            no                      reduced                 none
pre-presbyopic      hypermetrope            yes                     reduced                 none
pre-presbyopic      hypermetrope            yes                     normal                  none
presbyopic          myope                   no                      reduced                 none
presbyopic          myope                   no                      normal                  none
presbyopic          myope                   yes                     reduced                 none
presbyopic          hypermetrope            no                      reduced                 none
presbyopic          hypermetrope            yes                     reduced                 none
presbyopic          hypermetrope            yes                     normal                  none
-----------
Group: soft
young               myope                   no                      normal                  soft
young               hypermetrope            no                      normal                  soft
pre-presbyopic      myope                   no                      normal                  soft
pre-presbyopic      hypermetrope            no                      normal                  soft
presbyopic          hypermetrope            no                      normal                  soft
</code></pre>

<p>è¿™å‡ ä¸ªéƒ½æ˜¯<code>itertools</code>æ¨¡å—çš„å†…å®¹ï¼Œå¯å‚è€ƒ<a href="http://www.wklken.me/posts/2013/08/20/python-extra-itertools.html#itertoolsisliceiterable-stop">PYTHON-è¿›é˜¶-ITERTOOLSæ¨¡å—å°ç»“</a></p>



                <hr>

                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/operation/2015/09/07/make/" data-toggle="tooltip" data-placement="top" title="make,make installå‘½ä»¤">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/operation/2015/09/07/yum-error/" data-toggle="tooltip" data-placement="top" title="yumå¼‚å¸¸è§£å†³æ–¹æ¡ˆ">Next Post &rarr;</a>
                    </li>
                    
                </ul>


                

                

            </div>

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#linuxåŸºç¡€" title="linuxåŸºç¡€" rel="14">
                                    linuxåŸºç¡€
                                </a>
                            
        				
                            
                				<a href="/tags/#Python" title="Python" rel="20">
                                    Python
                                </a>
                            
        				
                            
                				<a href="/tags/#linuxæœåŠ¡å™¨" title="linuxæœåŠ¡å™¨" rel="10">
                                    linuxæœåŠ¡å™¨
                                </a>
                            
        				
                            
                				<a href="/tags/#Mysql" title="Mysql" rel="11">
                                    Mysql
                                </a>
                            
        				
                            
                				<a href="/tags/#OS System" title="OS System" rel="7">
                                    OS System
                                </a>
                            
        				
                            
                				<a href="/tags/#pythonæŠ€å·§" title="pythonæŠ€å·§" rel="21">
                                    pythonæŠ€å·§
                                </a>
                            
        				
                            
                				<a href="/tags/#redis" title="redis" rel="14">
                                    redis
                                </a>
                            
        				
                            
                				<a href="/tags/#django" title="django" rel="8">
                                    django
                                </a>
                            
        				
                            
                				<a href="/tags/#tornado" title="tornado" rel="6">
                                    tornado
                                </a>
                            
        				
                            
                				<a href="/tags/#Shell" title="Shell" rel="7">
                                    Shell
                                </a>
                            
        				
                            
                				<a href="/tags/#git" title="git" rel="5">
                                    git
                                </a>
                            
        				
                            
                				<a href="/tags/#webå¼€å‘" title="webå¼€å‘" rel="2">
                                    webå¼€å‘
                                </a>
                            
        				
                            
                				<a href="/tags/#jQuery" title="jQuery" rel="3">
                                    jQuery
                                </a>
                            
        				
                            
                				<a href="/tags/#äººç”Ÿ" title="äººç”Ÿ" rel="4">
                                    äººç”Ÿ
                                </a>
                            
        				
                            
                				<a href="/tags/#å¤‡ä»½" title="å¤‡ä»½" rel="2">
                                    å¤‡ä»½
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Nginx" title="Nginx" rel="3">
                                    Nginx
                                </a>
                            
        				
                            
                				<a href="/tags/#windowsæœåŠ¡å™¨" title="windowsæœåŠ¡å™¨" rel="3">
                                    windowsæœåŠ¡å™¨
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#pythonæ¨¡å—" title="pythonæ¨¡å—" rel="2">
                                    pythonæ¨¡å—
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#è¿ç»´" title="è¿ç»´" rel="4">
                                    è¿ç»´
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#pythonå¥‡æŠ€æ·«å·§" title="pythonå¥‡æŠ€æ·«å·§" rel="4">
                                    pythonå¥‡æŠ€æ·«å·§
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#python" title="python" rel="17">
                                    python
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Unixç½‘ç»œç¼–ç¨‹" title="Unixç½‘ç»œç¼–ç¨‹" rel="7">
                                    Unixç½‘ç»œç¼–ç¨‹
                                </a>
                            
        				
                            
                				<a href="/tags/#C" title="C" rel="2">
                                    C
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#ops" title="ops" rel="3">
                                    ops
                                </a>
                            
        				
                            
                				<a href="/tags/#book" title="book" rel="4">
                                    book
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#mongodb" title="mongodb" rel="6">
                                    mongodb
                                </a>
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/stevensia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Steven's Blog 2016
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
        hljs.initHighlightingOnLoad();
    })
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
